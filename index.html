<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Russo Gourmet | Card√°pio</title>
    <link rel="stylesheet" href="style.css">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;800&display=swap" rel="stylesheet">
</head>
<body>
    <section class="brand-section">
        <div class="logo-wrapper"><img src="russogourmet.png" class="logo-circle" alt="Logo"></div>
        <h1 class="brand-name">Russo Gourmet</h1>
        <div id="status-loja" style="font-weight: bold; margin-top: 5px; font-size: 0.9rem;"></div>
    </section>

    <nav class="sticky-nav">
        <div class="container">
            <input type="text" id="busca" class="search-box" placeholder="O que vamos pedir hoje?" onkeyup="filtrar()">
        </div>
    </nav>

    <main class="container" id="menu-render"></main>

    <div id="cart-bar" class="cart-bar" onclick="abrirCheckout()" style="display: none;">
        <span>üõí Ver sacola</span>
        <span id="cart-total-bar">R$ 0,00</span>
    </div>

    <div id="modal-checkout" class="modal-full">
        <div class="container">
            <h2 style="color: var(--primary); margin-bottom: 20px;">Resumo do Pedido</h2>
            <div id="itens-carrinho" style="margin-bottom: 20px;"></div>
            
            <div id="total-final" style="font-size: 1.4rem; font-weight: 800; text-align: right; margin-bottom: 25px; color: var(--primary);"></div>
            
            <div class="form-pedido">
                <input type="text" id="c-nome" class="search-box" placeholder="Seu Nome" style="margin-bottom: 12px; border-radius: 12px;">
                <input type="text" id="c-end" class="search-box" placeholder="Endere√ßo (Rua, N√∫mero, Bairro)" style="margin-bottom: 12px; border-radius: 12px;">
                <select id="c-pag" class="search-box" style="margin-bottom: 20px; border-radius: 12px;">
                    <option value="Pix">Pagar com Pix</option>
                    <option value="Cart√£o">Cart√£o na Entrega</option>
                    <option value="Dinheiro">Dinheiro (Levar troco)</option>
                </select>
                
                <button class="btn-order" onclick="enviarWhatsApp()" style="width: 100%; padding: 20px; font-size: 1.1rem; border-radius: 15px;">
                    CONCLUIR NO WHATSAPP
                </button>
                
                <button onclick="fecharModais()" style="width: 100%; background: none; border: none; margin-top: 20px; color: var(--accent); font-weight: 600; cursor: pointer;">
                    ‚Üê Adicionar mais itens
                </button>
            </div>
        </div>
    </div>

    <script>
        let carrinho = [];
        let lojaAberta = true;

        // Carrega os produtos que voc√™ salvou no Admin
        function renderizar() {
            const data = JSON.parse(localStorage.getItem('russo_db')) || {};
            const menu = document.getElementById('menu-render');
            menu.innerHTML = "";

            if (Object.keys(data).length === 0) {
                menu.innerHTML = "<p style='text-align:center; padding:50px;'>O card√°pio est√° sendo atualizado...</p>";
                return;
            }

            Object.keys(data).forEach(cat => {
                if(data[cat].length === 0) return;
                menu.innerHTML += `<h3 style="margin: 30px 15px 10px; color: var(--primary);">${cat}</h3>`;
                
                data[cat].forEach(p => {
                    const statusEsgotado = p.esgotado ? 'style="opacity: 0.5; filter: grayscale(1);"' : '';
                    
                    menu.innerHTML += `
                    <div class="product-card" data-nome="${p.nome.toLowerCase()}" ${statusEsgotado}>
                        <img src="${p.foto || 'https://via.placeholder.com/150'}" class="product-img">
                        <div style="flex:1">
                            <h4 style="font-size: 1rem; margin-bottom: 4px;">${p.nome}</h4>
                            <p style="font-size: 0.75rem; color: #777; margin-bottom: 8px;">${p.desc || ''}</p>
                            <div style="display:flex; justify-content:space-between; align-items:center;">
                                <span class="price-tag">R$ ${p.promo || p.preco}</span>
                                ${p.esgotado ? '<b style="color:#d9534f">ESGOTADO</b>' : 
                                `<button class="btn-order" onclick="addCarrinho('${p.nome}', '${p.promo || p.preco}')" style="padding: 8px 15px; font-size: 0.8rem;">+ Adicionar</button>`}
                            </div>
                        </div>
                    </div>`;
                });
            });
        }

        function addCarrinho(nome, preco) {
            const valor = parseFloat(preco.replace(',', '.'));
            const item = carrinho.find(i => i.nome === nome);
            if(item) { item.qtd++; } else { carrinho.push({ nome, preco: valor, qtd: 1 }); }
            atualizarBarra();
        }

        function atualizarBarra() {
            const bar = document.getElementById('cart-bar');
            const total = carrinho.reduce((acc, i) => acc + (i.preco * i.qtd), 0);
            if(carrinho.length > 0) {
                bar.style.display = 'flex';
                document.getElementById('cart-total-bar').innerText = `R$ ${total.toFixed(2).replace('.', ',')}`;
            } else { bar.style.display = 'none'; }
        }

        function abrirCheckout() {
            const container = document.getElementById('itens-carrinho');
            container.innerHTML = "";
            let total = 0;
            carrinho.forEach((item, idx) => {
                total += (item.preco * item.qtd);
                container.innerHTML += `
                <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:12px; background:white; padding:12px; border-radius:12px; border: 1px solid #eee;">
                    <div><strong>${item.qtd}x ${item.nome}</strong></div>
                    <div style="font-weight: bold; color: var(--accent);">R$ ${(item.preco * item.qtd).toFixed(2).replace('.', ',')}</div>
                </div>`;
            });
            document.getElementById('total-final').innerText = `Total: R$ ${total.toFixed(2).replace('.', ',')}`;
            document.getElementById('modal-checkout').style.display = 'block';
        }

        function enviarWhatsApp() {
            const nome = document.getElementById('c-nome').value;
            const endereco = document.getElementById('c-end').value;
            const pag = document.getElementById('c-pag').value;

            if(!nome || !endereco) {
                alert("Por favor, preencha seu nome e endere√ßo.");
                return;
            }

            const itens = carrinho.map(i => `‚Ä¢ ${i.qtd}x ${i.nome} (R$ ${(i.preco * i.qtd).toFixed(2)})`).join('%0A');
            const total = carrinho.reduce((acc, i) => acc + (i.preco * i.qtd), 0).toFixed(2);

            const texto = `*NOVO PEDIDO - RUSSO GOURMET*%0A%0A*Cliente:* ${nome}%0A*Endere√ßo:* ${endereco}%0A*Pagamento:* ${pag}%0A%0A*ITENS:*%0A${itens}%0A%0A*TOTAL: R$ ${total.replace('.', ',')}*`;
            
            // Seu n√∫mero de WhatsApp aqui
            const fone = "5513982155569";
            window.open(`https://wa.me/${fone}?text=${texto}`);
            
            carrinho = [];
            atualizarBarra();
            fecharModais();
        }

        function fecharModais() { document.getElementById('modal-checkout').style.display = 'none'; }
        
        function filtrar() {
            const busca = document.getElementById('busca').value.toLowerCase();
            document.querySelectorAll('.product-card').forEach(card => {
                const nome = card.dataset.nome;
                card.style.display = nome.includes(busca) ? 'flex' : 'none';
            });
        }

        window.onload = renderizar;
    </script>
</body>
</html>
