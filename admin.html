<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <title>Painel Russo Gourmet</title>
    <link rel="stylesheet" href="style.css">
    <style>
        body { display: flex; background: #fdfaf5; }
        .sidebar { width: 220px; background: #3d2b1f; color: white; height: 100vh; position: fixed; padding: 20px; }
        .sidebar button { width: 100%; padding: 12px; margin-bottom: 10px; background: none; border: none; color: white; text-align: left; cursor: pointer; font-weight: bold; border-radius: 8px; }
        .sidebar button.active { background: #5c4033; }
        .main { margin-left: 220px; flex: 1; padding: 30px; }
        .card-adm { background: white; padding: 20px; border-radius: 12px; margin-bottom: 15px; border: 1px solid #eaddcf; }
        .item-row { display: flex; justify-content: space-between; padding: 10px 0; border-bottom: 1px solid #f2ece4; align-items: center; }
        input, textarea, select { width: 100%; padding: 12px; margin-bottom: 10px; border: 1px solid #ddd; border-radius: 8px; }
    </style>
</head>
<body>
    <div class="sidebar">
        <h3>Painel Russo</h3><br>
        <button onclick="aba('p')" id="btn-p" class="active">Pedidos</button>
        <button onclick="aba('c')" id="btn-c">Card√°pio</button>
        <button onclick="aba('h')" id="btn-h">Hor√°rios</button>
    </div>

    <main class="main">
        <section id="sec-p"><h2>Pedidos</h2><div id="lista-p"></div></section>
        
        <section id="sec-c" style="display:none">
            <h2>Gerenciar Itens</h2>
            <div id="grid-c" style="display:grid; grid-template-columns: repeat(auto-fill, minmax(280px, 1fr)); gap: 15px; margin-top:20px;"></div>
        </section>

        <section id="sec-h" style="display:none">
            <h2>Hor√°rios</h2>
            <div class="card-adm" id="grid-h"></div>
            <button class="btn-order" onclick="salvarH()" style="width:200px">Salvar Hor√°rios</button>
        </section>
    </main>

    <div id="modal-edicao" style="display:none; position:fixed; inset:0; background:rgba(0,0,0,0.7); z-index:3000; align-items:center; justify-content:center;">
        <div class="card-adm" style="width: 400px;">
            <h3 id="m-titulo">Editar Item</h3><br>
            <input type="hidden" id="edit-idx">
            <input type="text" id="m-nome" placeholder="Nome">
            <textarea id="m-desc" placeholder="Descri√ß√£o"></textarea>
            <input type="text" id="m-preco" placeholder="Pre√ßo (Ex: 10,00)">
            <input type="text" id="m-promo" placeholder="Pre√ßo Promo√ß√£o (Opcional)">
            <input type="text" id="m-foto" placeholder="Link da Imagem">
            <button class="btn-order" onclick="salvarItem()" style="width:100%; padding: 15px;">Salvar Item</button>
            <button onclick="document.getElementById('modal-edicao').style.display='none'" style="width:100%; border:none; background:none; margin-top:10px; cursor:pointer;">Cancelar</button>
        </div>
    </div>

    <script>
        const categorias = ["Morango do amor", "Coxinha russo", "Copo da felicidade-200ml", "Combinho russo(1 pessoa)", "Combinho casal(2 pessoas)", "Fatia cookie", "Piscininha recheada", "Barras recheadas", "Fatia brownie", "Copos da felicidade", "Mega cone trufado", "Bebidas", "Combo russo2.0", "Combo russo3.0", "Combinho russo", "Marmitinha"];
        let catAtual = "";

        function aba(id) {
            ['p', 'c', 'h'].forEach(x => {
                document.getElementById('sec-'+x).style.display = id === x ? 'block' : 'none';
                document.getElementById('btn-'+x).classList.toggle('active', id === x);
            });
            if(id === 'c') renderC();
            if(id === 'h') renderH();
        }

        function renderC() {
            const data = JSON.parse(localStorage.getItem('russo_db')) || {};
            const grid = document.getElementById('grid-c');
            grid.innerHTML = categorias.map(cat => `
                <div class="card-adm">
                    <div style="display:flex; justify-content:space-between"><b>${cat}</b> <button onclick="abrirM('${cat}')" style="background:var(--primary); color:white; border:none; padding:4px 8px; border-radius:4px;">+</button></div>
                    ${(data[cat] || []).map((p, i) => `
                        <div class="item-row" style="${p.esgotado ? 'opacity:0.5' : ''}">
                            <small>${p.nome}</small>
                            <div>
                                <button onclick="toggleEsgotado('${cat}', ${i})" style="border:none; background:none; cursor:pointer;">${p.esgotado ? '‚ùå' : '‚úÖ'}</button>
                                <button onclick="editar('${cat}', ${i})" style="border:none; background:none; cursor:pointer; margin-left:5px;">‚úèÔ∏è</button>
                                <button onclick="excluir('${cat}', ${i})" style="border:none; background:none; cursor:pointer; color:red; margin-left:5px;">üóëÔ∏è</button>
                            </div>
                        </div>`).join('')}
                </div>`).join('');
        }

        function toggleEsgotado(cat, i) {
            const data = JSON.parse(localStorage.getItem('russo_db'));
            data[cat][i].esgotado = !data[cat][i].esgotado;
            localStorage.setItem('russo_db', JSON.stringify(data));
            renderC();
        }

        function abrirM(cat) {
            catAtual = cat; document.getElementById('edit-idx').value = "";
            document.getElementById('m-nome').value = ""; document.getElementById('m-preco').value = "";
            document.getElementById('m-desc').value = ""; document.getElementById('m-promo').value = "";
            document.getElementById('m-foto').value = "";
            document.getElementById('modal-edicao').style.display = 'flex';
        }

        function editar(cat, i) {
            catAtual = cat;
            const p = JSON.parse(localStorage.getItem('russo_db'))[cat][i];
            document.getElementById('edit-idx').value = i;
            document.getElementById('m-nome').value = p.nome;
            document.getElementById('m-desc').value = p.desc || "";
            document.getElementById('m-preco').value = p.preco;
            document.getElementById('m-promo').value = p.promo || "";
            document.getElementById('m-foto').value = p.foto || "";
            document.getElementById('modal-edicao').style.display = 'flex';
        }

        function salvarItem() {
            const data = JSON.parse(localStorage.getItem('russo_db')) || {};
            const idx = document.getElementById('edit-idx').value;
            const obj = {
                nome: document.getElementById('m-nome').value,
                desc: document.getElementById('m-desc').value,
                preco: document.getElementById('m-preco').value,
                promo: document.getElementById('m-promo').value,
                foto: document.getElementById('m-foto').value,
                esgotado: (idx !== "") ? data[catAtual][idx].esgotado : false
            };
            if(!data[catAtual]) data[catAtual] = [];
            if(idx === "") { data[catAtual].push(obj); } else { data[catAtual][idx] = obj; }
            localStorage.setItem('russo_db', JSON.stringify(data));
            document.getElementById('modal-edicao').style.display = 'none';
            renderC();
        }

        function excluir(cat, i) {
            if(confirm("Excluir item?")) {
                const d = JSON.parse(localStorage.getItem('russo_db'));
                d[cat].splice(i, 1);
                localStorage.setItem('russo_db', JSON.stringify(d));
                renderC();
            }
        }

        function renderH() {
            const h = JSON.parse(localStorage.getItem('russo_horas')) || {};
            const dias = ["Segunda","Ter√ßa","Quarta","Quinta","Sexta","S√°bado","Domingo"];
            document.getElementById('grid-h').innerHTML = dias.map(d => `
                <div style="display:flex; justify-content:space-between; margin-bottom:10px;">
                    <span><b>${d}</b></span>
                    <div><input type="time" id="a-${d}" style="width:80px" value="${h[d]?.abre || '09:00'}"> √†s <input type="time" id="f-${d}" style="width:80px" value="${h[d]?.fecha || '23:00'}"></div>
                </div>`).join('');
        }

        function salvarH() {
            const h = {};
            ["Segunda","Ter√ßa","Quarta","Quinta","Sexta","S√°bado","Domingo"].forEach(d => {
                h[d] = { abre: document.getElementById('a-'+d).value, fecha: document.getElementById('f-'+d).value };
            });
            localStorage.setItem('russo_horas', JSON.stringify(h));
            alert("Hor√°rios salvos!");
        }

        window.onload = () => aba('p');
    </script>
</body>
</html>